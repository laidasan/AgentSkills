# 6. 外部依賴與技術約束

## 目的

提前揭露外部風險，讓團隊知道哪些事情不在自己掌控範圍內，並提供備援方案降低風險。

## 撰寫規範

### 基本結構

```markdown
## 外部依賴與技術約束

### 後端服務依賴
| 服務名稱 | 依賴內容 | 負責人 | 預計完成日 | 風險等級 | 備援方案 |
|---------|---------|--------|-----------|---------|---------|
| 購物車 API | 提供 CRUD 操作的 RESTful API | 後端工程師 A | 2025/02/15 | 🟢 低 | - |
| 庫存檢查 API | 即時檢查商品庫存狀態 | 後端工程師 B | 2025/02/20 | 🟡 中 | 若延遲,前端暫時跳過即時檢查，結帳時再統一檢查庫存 |

### 第三方服務依賴
| 服務名稱 | 依賴內容 | 預計完成日 | 風險等級 | 備援方案 |
|---------|---------|-----------|---------|---------|
| CDN 圖片服務 | 提供商品圖片載入 | - | 🟡 中 | 若 CDN 異常，改用本地圖片快取或顯示預設圖片 |

### 開發順序約束
1. 必須先完成「購物車 API」才能開始前端開發
2. 「庫存檢查功能」可與購物車並行開發，但上線前必須完成
   - **備援方案**：若「庫存檢查 API」延遲，先上線不含即時檢查的版本，結帳時才檢查庫存

### 技術約束
- 前端需支援 IE 11 以上瀏覽器
- localStorage 儲存上限為 5MB
- API 請求逾時時間設定為 5 秒
```

## 關鍵要素

### 1. 依賴項目分類
- **後端服務依賴**：內部團隊開發的服務
- **第三方服務依賴**：外部供應商或開源專案提供的服務
- **基礎設施依賴**：雲端服務、資料庫、伺服器等

### 2. 風險等級定義
使用顏色標示風險：
- **🟢 低風險**：時程確定、技術成熟、有備援方案
- **🟡 中風險**：時程可能延遲、技術有挑戰、備援方案可行
- **🔴 高風險**：時程不確定、技術不成熟、無備援方案

### 3. 備援方案類型

#### 降級方案
功能簡化但仍可運作：
- 跳過即時檢查，結帳時才檢查
- 取消自動同步，改為手動同步
- 減少資料載入量，提升效能

#### 替代方案
使用其他技術或服務：
- CDN 異常改用本地快取
- 第三方 API 失敗改用備用 API
- 雲端服務異常改用本地服務

#### 延後方案
功能延後到下一版本：
- 非核心功能延後上線
- 優化項目延後實作

### 4. 預計完成日
- **來源**：與負責人確認的時間
- **更新頻率**：定期更新（如每週 Standup）
- **標註狀態**：可標註「已完成」、「進行中」、「延遲」等狀態

## 撰寫技巧

### 技巧 1：備援方案要具體可執行
❌ **模糊描述**：「若延遲再討論」、「待確認」
✅ **具體描述**：「若延遲，前端暫時跳過即時檢查，結帳時再統一檢查庫存」

### 技巧 2：風險等級要基於客觀評估
評估依據：
- 時程確定性（負責人承諾、歷史經驗）
- 技術成熟度（是否有先例、文件是否完整）
- 備援方案可行性（是否經過驗證）

### 技巧 3：定期追蹤和更新
建議每週檢查：
- 預計完成日是否需要調整
- 風險等級是否需要升級或降級
- 備援方案是否需要啟動

### 技巧 4：區分「依賴」和「約束」
- **依賴**：需要其他服務或團隊提供的內容
- **約束**：技術或業務上的限制條件

## 備援方案設計原則

### 原則 1：優先考慮降級方案
降級方案通常比替代方案更容易實作且風險更低。

### 原則 2：備援方案要提前驗證
不要等到問題發生才測試備援方案，應在開發階段就驗證可行性。

### 原則 3：高風險項目必須有備援方案
若風險等級為 🔴 高且無備援方案，應：
- 升級為專案風險，提報給管理層
- 調整專案範圍或時程
- 尋找替代方案

### 原則 4：備援方案要有觸發條件
明確定義何時啟動備援方案：
- 時間觸發：若在 X 日前未完成，啟動備援方案
- 狀態觸發：若技術評估結果為不可行，啟動備援方案

## 注意事項

1. **預計完成日要與負責人確認**：不要自行假設，應與相關負責人確認並取得承諾
2. **備援方案要具體可執行**：避免「再討論」、「待確認」等模糊描述
3. **高風險項目要特別標註**：若風險等級為 🔴 高，應在專案會議中特別追蹤
4. **定期更新狀態**：依賴項目的狀態會變化，需定期更新此章節
5. **跨團隊溝通**：依賴項目涉及其他團隊時，應確保溝通管道暢通

## 常見錯誤

❌ **錯誤示範 1**：備援方案不具體
```markdown
| 庫存檢查 API | ... | 🟡 中 | 若延遲再討論 |
```
**問題**：「再討論」不是可執行的備援方案

✅ **正確示範**：
```markdown
| 庫存檢查 API | ... | 🟡 中 | 若延遲，前端暫時跳過即時檢查，結帳時再統一檢查庫存 |
```

❌ **錯誤示範 2**：高風險項目無備援方案
```markdown
| 付款 API | ... | 🔴 高 | - |
```
**問題**：高風險項目必須有備援方案或應對策略

✅ **正確示範**：
```markdown
| 付款 API | ... | 🔴 高 | 已升級為專案風險，每日追蹤進度；若無法如期完成，調整上線時程 |
```

❌ **錯誤示範 3**：預計完成日未確認
```markdown
| 購物車 API | ... | TBD | ... |
```
**問題**：時程不明確，無法規劃開發

✅ **正確示範**：
```markdown
| 購物車 API | ... | 2025/02/15（已與後端工程師 A 確認） | ... |
```

## 適用場景

- ✅ 專案啟動時，識別所有外部依賴
- ✅ 技術評估時，評估風險並規劃備援方案
- ✅ 每週會議，追蹤依賴項目進度
- ✅ 風險發生時，啟動備援方案

## 與其他章節的關聯

- **功能範疇與邊界**：若依賴項目風險高，可能需調整功能範圍
- **優先級**：依賴項目的完成時間會影響功能的開發優先級
- **變更日誌**：若依賴項目延遲導致需求變更，應記錄在變更日誌
- **開發時程**：依賴項目的完成時間會影響整體開發時程

## 風險追蹤範本

```markdown
## 依賴項目追蹤（每週更新）

| 服務名稱 | 當前狀態 | 進度 | 風險變化 | 行動項目 |
|---------|---------|------|---------|---------|
| 購物車 API | 進行中 | 80% | 🟢 → 🟢 | 預計如期完成 |
| 庫存檢查 API | 延遲 | 40% | 🟡 → 🔴 | 已啟動備援方案，前端跳過即時檢查 |
```

## 驗證檢查

完成此章節後，檢查以下項目：
- [ ] 所有外部依賴都已列出
- [ ] 每個依賴項目都有風險等級標註
- [ ] 中高風險項目都有備援方案
- [ ] 預計完成日已與負責人確認
- [ ] 開發順序約束已明確標註
- [ ] 技術約束已清楚說明
